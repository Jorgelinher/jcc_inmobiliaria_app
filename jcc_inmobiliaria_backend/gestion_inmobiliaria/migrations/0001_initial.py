# Generated by Django 5.2.1 on 2025-07-15 16:19

import django.core.validators
import django.db.models.deletion
import django.utils.timezone
import uuid
from decimal import Decimal
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='Cliente',
            fields=[
                ('id_cliente', models.CharField(editable=False, max_length=50, primary_key=True, serialize=False, unique=True, verbose_name='ID Cliente')),
                ('tipo_documento', models.CharField(choices=[('DNI', 'DNI'), ('RUC', 'RUC'), ('CE', 'Carnet de Extranjería'), ('Pasaporte', 'Pasaporte'), ('Otro', 'Otro')], max_length=15, verbose_name='Tipo de Documento')),
                ('numero_documento', models.CharField(blank=True, max_length=20, null=True, verbose_name='Número de Documento')),
                ('nombres_completos_razon_social', models.CharField(max_length=255, verbose_name='Nombres Completos / Razón Social')),
                ('fecha_nacimiento_constitucion', models.DateField(blank=True, null=True, verbose_name='Fecha Nacimiento/Constitución')),
                ('direccion', models.CharField(blank=True, max_length=255, null=True, verbose_name='Dirección')),
                ('distrito', models.CharField(blank=True, max_length=100, null=True)),
                ('provincia', models.CharField(blank=True, max_length=100, null=True)),
                ('departamento', models.CharField(blank=True, max_length=100, null=True)),
                ('telefono_principal', models.CharField(blank=True, max_length=20, null=True, verbose_name='Teléfono Principal')),
                ('telefono_secundario', models.CharField(blank=True, max_length=20, null=True, verbose_name='Teléfono Secundario')),
                ('email_principal', models.EmailField(blank=True, max_length=255, null=True, verbose_name='Email Principal')),
                ('email_secundario', models.EmailField(blank=True, max_length=255, null=True, verbose_name='Email Secundario')),
                ('estado_civil', models.CharField(blank=True, choices=[('Soltero(a)', 'Soltero(a)'), ('Casado(a)', 'Casado(a)'), ('Viudo(a)', 'Viudo(a)'), ('Divorciado(a)', 'Divorciado(a)'), ('Conviviente', 'Conviviente')], max_length=20, null=True, verbose_name='Estado Civil')),
                ('profesion_ocupacion', models.CharField(blank=True, max_length=100, null=True, verbose_name='Profesión/Ocupación')),
                ('fecha_registro', models.DateTimeField(default=django.utils.timezone.now, editable=False)),
                ('ultima_modificacion', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Cliente',
                'verbose_name_plural': 'Clientes',
                'ordering': ['nombres_completos_razon_social'],
            },
        ),
        migrations.CreateModel(
            name='ConfigGeneral',
            fields=[
                ('parametro', models.CharField(max_length=100, primary_key=True, serialize=False, unique=True, verbose_name='Parámetro')),
                ('valor', models.CharField(max_length=255, verbose_name='Valor')),
                ('descripcion', models.TextField(blank=True, null=True, verbose_name='Descripción')),
            ],
            options={
                'verbose_name': 'Configuración General',
                'verbose_name_plural': 'Configuraciones Generales',
            },
        ),
        migrations.CreateModel(
            name='CuotaPlanPago',
            fields=[
                ('id_cuota', models.AutoField(primary_key=True, serialize=False)),
                ('numero_cuota', models.PositiveSmallIntegerField(verbose_name='Número de Cuota')),
                ('fecha_vencimiento', models.DateField(verbose_name='Fecha de Vencimiento')),
                ('monto_programado', models.DecimalField(decimal_places=2, max_digits=10, verbose_name='Monto Programado de Cuota')),
                ('monto_pagado', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=10, verbose_name='Monto Pagado')),
                ('estado_cuota', models.CharField(choices=[('pendiente', 'Pendiente'), ('pagada', 'Pagada'), ('parcialmente_pagada', 'Parcialmente Pagada'), ('atrasada', 'Atrasada'), ('vencida_no_pagada', 'Vencida No Pagada'), ('cancelada_con_excedente', 'Cancelada con Excedente')], default='pendiente', max_length=25, verbose_name='Estado de la Cuota')),
                ('fecha_pago_efectivo', models.DateField(blank=True, null=True, verbose_name='Fecha de Último Pago/Pago Completo')),
                ('monto_programado_dolares', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True, verbose_name='Monto Programado de Cuota ($)')),
            ],
            options={
                'verbose_name': 'Cuota de Plan de Pago',
                'verbose_name_plural': 'Cuotas de Planes de Pago',
                'ordering': ['plan_pago_venta', 'numero_cuota'],
            },
        ),
        migrations.CreateModel(
            name='LogAuditoriaCambio',
            fields=[
                ('id_log', models.AutoField(primary_key=True, serialize=False)),
                ('timestamp', models.DateTimeField(default=django.utils.timezone.now, verbose_name='Fecha y Hora')),
                ('usuario_email', models.CharField(max_length=255, verbose_name='Usuario Email')),
                ('accion', models.CharField(max_length=50, verbose_name='Acción')),
                ('modulo', models.CharField(max_length=50, verbose_name='Módulo Afectado')),
                ('id_registro_afectado', models.CharField(blank=True, max_length=100, null=True, verbose_name='ID Registro Afectado')),
                ('campo_modificado', models.CharField(blank=True, max_length=100, null=True, verbose_name='Campo Modificado')),
                ('valor_antiguo', models.TextField(blank=True, null=True, verbose_name='Valor Antiguo')),
                ('valor_nuevo', models.TextField(blank=True, null=True, verbose_name='Valor Nuevo')),
                ('detalles_adicionales', models.TextField(blank=True, null=True, verbose_name='Detalles Adicionales')),
            ],
            options={
                'verbose_name': 'Log de Auditoría',
                'verbose_name_plural': 'Logs de Auditoría',
                'ordering': ['-timestamp'],
            },
        ),
        migrations.CreateModel(
            name='Lote',
            fields=[
                ('id_lote', models.CharField(editable=False, max_length=50, primary_key=True, serialize=False, unique=True, verbose_name='ID Lote')),
                ('ubicacion_proyecto', models.CharField(max_length=255, verbose_name='Ubicación del Proyecto')),
                ('manzana', models.CharField(blank=True, max_length=50, null=True, verbose_name='Manzana')),
                ('numero_lote', models.CharField(blank=True, max_length=50, null=True, verbose_name='Número de Lote')),
                ('etapa', models.PositiveSmallIntegerField(blank=True, help_text='Número de la etapa del lote dentro del proyecto (ej: 1, 2, 3)', null=True, verbose_name='Etapa del Lote (Número)')),
                ('area_m2', models.DecimalField(decimal_places=2, max_digits=10, verbose_name='Área (m²)')),
                ('precio_lista_soles', models.DecimalField(blank=True, decimal_places=2, max_digits=12, null=True, verbose_name='Precio Contado (S/.)')),
                ('precio_credito_12_meses_soles', models.DecimalField(blank=True, decimal_places=2, max_digits=12, null=True, verbose_name='Precio Crédito 12 Meses (S/.)')),
                ('precio_credito_24_meses_soles', models.DecimalField(blank=True, decimal_places=2, max_digits=12, null=True, verbose_name='Precio Crédito 24 Meses (S/.)')),
                ('precio_credito_36_meses_soles', models.DecimalField(blank=True, decimal_places=2, max_digits=12, null=True, verbose_name='Precio Crédito 36 Meses (S/.)')),
                ('precio_lista_dolares', models.DecimalField(blank=True, decimal_places=2, max_digits=12, null=True, verbose_name='Precio Lista ($) (Opcional)')),
                ('precio_credito_12_meses_dolares', models.DecimalField(blank=True, decimal_places=2, max_digits=12, null=True, verbose_name='Precio Crédito 12 Meses ($)')),
                ('precio_credito_24_meses_dolares', models.DecimalField(blank=True, decimal_places=2, max_digits=12, null=True, verbose_name='Precio Crédito 24 Meses ($)')),
                ('precio_credito_36_meses_dolares', models.DecimalField(blank=True, decimal_places=2, max_digits=12, null=True, verbose_name='Precio Crédito 36 Meses ($)')),
                ('estado_lote', models.CharField(choices=[('Disponible', 'Disponible'), ('Reservado', 'Reservado'), ('Vendido', 'Vendido')], default='Disponible', max_length=20, verbose_name='Estado del Lote')),
                ('colindancias', models.TextField(blank=True, null=True, verbose_name='Colindancias')),
                ('partida_registral', models.CharField(blank=True, max_length=100, null=True, verbose_name='Partida Registral')),
                ('observaciones_lote', models.TextField(blank=True, null=True, verbose_name='Observaciones del Lote')),
                ('fecha_creacion', models.DateTimeField(default=django.utils.timezone.now, editable=False)),
                ('ultima_modificacion', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Lote',
                'verbose_name_plural': 'Lotes',
                'ordering': ['ubicacion_proyecto', 'etapa', 'manzana', 'numero_lote'],
            },
        ),
        migrations.CreateModel(
            name='PlanPagoVenta',
            fields=[
                ('id_plan_pago', models.AutoField(primary_key=True, serialize=False)),
                ('monto_total_credito', models.DecimalField(decimal_places=2, max_digits=12, verbose_name='Monto Total del Crédito (Post Cuota Inicial)')),
                ('numero_cuotas', models.PositiveSmallIntegerField(verbose_name='Número de Cuotas')),
                ('monto_cuota_regular_original', models.DecimalField(decimal_places=2, max_digits=10, verbose_name='Monto de Cuota Regular Original')),
                ('fecha_inicio_pago_cuotas', models.DateField(verbose_name='Fecha de Vencimiento de Primera Cuota')),
                ('observaciones', models.TextField(blank=True, null=True)),
                ('fecha_creacion', models.DateTimeField(auto_now_add=True)),
                ('ultima_modificacion', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Plan de Pago de Venta',
                'verbose_name_plural': 'Planes de Pago de Ventas',
                'ordering': ['-fecha_creacion'],
            },
        ),
        migrations.CreateModel(
            name='Asesor',
            fields=[
                ('id_asesor', models.CharField(editable=False, max_length=50, primary_key=True, serialize=False, unique=True, verbose_name='ID Asesor')),
                ('nombre_asesor', models.CharField(max_length=255, verbose_name='Nombre Completo del Asesor')),
                ('dni', models.CharField(blank=True, max_length=8, null=True, unique=True, verbose_name='DNI')),
                ('fecha_nacimiento', models.DateField(blank=True, null=True, verbose_name='Fecha de Nacimiento')),
                ('estado_civil', models.CharField(blank=True, choices=[('Soltero(a)', 'Soltero(a)'), ('Casado(a)', 'Casado(a)'), ('Viudo(a)', 'Viudo(a)'), ('Divorciado(a)', 'Divorciado(a)'), ('Conviviente', 'Conviviente')], max_length=20, null=True, verbose_name='Estado Civil')),
                ('numero_hijos', models.PositiveSmallIntegerField(blank=True, default=0, null=True, verbose_name='Número de Hijos')),
                ('direccion', models.CharField(blank=True, max_length=255, null=True, verbose_name='Dirección del Asesor')),
                ('distrito', models.CharField(blank=True, max_length=100, null=True, verbose_name='Distrito del Asesor')),
                ('telefono_personal', models.CharField(blank=True, max_length=20, null=True, verbose_name='Teléfono Personal')),
                ('email_personal', models.EmailField(blank=True, max_length=255, null=True, verbose_name='Email Personal')),
                ('banco_preferido', models.CharField(blank=True, max_length=100, null=True, verbose_name='Banco Preferido')),
                ('fecha_ingreso', models.DateField(verbose_name='Fecha de Ingreso a la Empresa')),
                ('fecha_cambio_socio', models.DateField(blank=True, null=True, verbose_name='Fecha Cambio a Socio (si aplica)')),
                ('observaciones_asesor', models.TextField(blank=True, null=True, verbose_name='Observaciones Adicionales')),
                ('fecha_registro_sistema', models.DateTimeField(default=django.utils.timezone.now, editable=False, verbose_name='Fecha de Registro en Sistema')),
                ('ultima_modificacion_sistema', models.DateTimeField(auto_now=True, verbose_name='Última Modificación en Sistema')),
                ('banco', models.CharField(blank=True, choices=[('BCP', 'Banco de Crédito BCP'), ('Interbank', 'Interbank'), ('Scotiabank', 'Scotiabank'), ('BBVA', 'BBVA Continental'), ('Otro', 'Otro Banco (especificar en notas)')], max_length=50, null=True, verbose_name='Banco Principal')),
                ('numero_cuenta_bancaria', models.CharField(blank=True, max_length=50, null=True, verbose_name='Número de Cuenta Bancaria Principal')),
                ('cci_cuenta_bancaria', models.CharField(blank=True, max_length=50, null=True, verbose_name='CCI Cuenta Bancaria Principal')),
                ('cuenta_bancaria_otros', models.TextField(blank=True, null=True, verbose_name='Otras Cuentas o Detalles Bancarios Adicionales')),
                ('id_referidor', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='referidos', to='gestion_inmobiliaria.asesor', verbose_name='ID Referidor (Líder)')),
            ],
            options={
                'verbose_name': 'Asesor',
                'verbose_name_plural': 'Asesores',
                'ordering': ['nombre_asesor'],
            },
        ),
        migrations.CreateModel(
            name='ActividadDiaria',
            fields=[
                ('id_actividad', models.CharField(editable=False, max_length=50, primary_key=True, serialize=False, unique=True, verbose_name='ID Actividad')),
                ('fecha_actividad', models.DateField(verbose_name='Fecha de Actividad')),
                ('datos_captados_opc', models.IntegerField(default=0, verbose_name='Datos Captados OPC')),
                ('llamadas_realizadas', models.IntegerField(default=0, verbose_name='Datos Gestionados')),
                ('presencias_generadas', models.IntegerField(default=0, verbose_name='Presencias Generadas')),
                ('notas_actividad', models.TextField(blank=True, null=True, verbose_name='Notas de Actividad')),
                ('asesor', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='actividades_diarias_asesor', to='gestion_inmobiliaria.asesor', verbose_name='Asesor')),
            ],
            options={
                'verbose_name': 'Actividad Diaria',
                'verbose_name_plural': 'Actividades Diarias',
                'ordering': ['-fecha_actividad', 'asesor'],
            },
        ),
        migrations.CreateModel(
            name='CierreComisionMensual',
            fields=[
                ('id_cierre', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('mes', models.IntegerField()),
                ('año', models.IntegerField()),
                ('status', models.CharField(choices=[('ABIERTO', 'Abierto'), ('CERRADO', 'Cerrado'), ('PAGADO', 'Pagado')], default='ABIERTO', max_length=10)),
                ('fecha_cierre', models.DateTimeField(blank=True, help_text='Fecha y hora en que se ejecutó el cierre.', null=True)),
                ('monto_total_comisiones', models.DecimalField(decimal_places=2, default=0.0, max_digits=12)),
                ('cerrado_por', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='cierres_realizados', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Cierre de Comisión Mensual',
                'verbose_name_plural': 'Cierres de Comisiones Mensuales',
                'ordering': ['-año', '-mes'],
                'unique_together': {('mes', 'año')},
            },
        ),
        migrations.CreateModel(
            name='ComisionVentaAsesor',
            fields=[
                ('id_comision_venta_asesor', models.AutoField(primary_key=True, serialize=False)),
                ('rol', models.CharField(choices=[('captacion_opc', 'Captación OPC/Redes'), ('call', 'Call (Agendó)'), ('liner', 'Liner (Presentación)'), ('closer', 'Closer (Cierre)'), ('otro', 'Otro')], max_length=20, verbose_name='Rol del Asesor en la Venta')),
                ('porcentaje_comision', models.DecimalField(decimal_places=2, max_digits=5, validators=[django.core.validators.MinValueValidator(Decimal('0.00')), django.core.validators.MaxValueValidator(Decimal('100.00'))], verbose_name='Porcentaje de Comisión Asignado (%)')),
                ('monto_comision_calculado', models.DecimalField(blank=True, decimal_places=2, max_digits=12, null=True, verbose_name='Monto Comisión Calculado (S/.)')),
                ('notas', models.TextField(blank=True, null=True, verbose_name='Notas Adicionales')),
                ('fecha_registro', models.DateTimeField(default=django.utils.timezone.now, editable=False)),
                ('ultima_modificacion', models.DateTimeField(auto_now=True)),
                ('asesor', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='comisiones_en_ventas', to='gestion_inmobiliaria.asesor', verbose_name='Asesor Involucrado')),
            ],
            options={
                'verbose_name': 'Comisión de Venta por Asesor',
                'verbose_name_plural': 'Comisiones de Ventas por Asesor',
                'ordering': ['venta', 'asesor'],
            },
        ),
        migrations.CreateModel(
            name='DefinicionMetaComision',
            fields=[
                ('id_definicion', models.AutoField(primary_key=True, serialize=False)),
                ('mes_en_rol', models.IntegerField(verbose_name='Mes en Rol')),
                ('meta_datos_opc', models.IntegerField(default=0, verbose_name='Meta Datos OPC')),
                ('meta_presencias', models.IntegerField(default=0, verbose_name='Meta Presencias')),
                ('meta_ventas_directas', models.IntegerField(default=0, verbose_name='Meta Ventas Directas')),
                ('meta_juniors_captados', models.IntegerField(default=0, verbose_name='Meta Juniors Captados')),
                ('meta_ventas_equipo_socio', models.IntegerField(default=0, verbose_name='Meta Ventas Equipo (Socio)')),
                ('meta_cierres_socio_equipo', models.IntegerField(default=0, verbose_name='Meta Cierres Socio (Ventas Equipo)')),
                ('comision_residual_venta_equipo_porc', models.DecimalField(decimal_places=4, default=0.0, max_digits=5, verbose_name='Comisión Residual por Venta Equipo (%)')),
            ],
            options={
                'verbose_name': 'Definición de Meta y Comisión',
                'verbose_name_plural': 'Definiciones de Metas y Comisiones',
                'ordering': ['mes_en_rol'],
                'unique_together': {('mes_en_rol',)},
            },
        ),
        migrations.CreateModel(
            name='DetalleComisionCerrada',
            fields=[
                ('id_detalle', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('asesor_nombre', models.CharField(max_length=255)),
                ('asesor_dni', models.CharField(max_length=20)),
                ('venta_id', models.CharField(max_length=20)),
                ('lote_str', models.CharField(max_length=255)),
                ('fecha_venta', models.DateField()),
                ('rol_en_venta', models.CharField(max_length=100)),
                ('monto_base_calculo', models.DecimalField(decimal_places=2, max_digits=12)),
                ('porcentaje_comision_aplicado', models.DecimalField(decimal_places=2, max_digits=5)),
                ('monto_comision_final', models.DecimalField(decimal_places=2, max_digits=12)),
                ('cierre', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='detalles', to='gestion_inmobiliaria.cierrecomisionmensual')),
                ('comision_original', models.OneToOneField(help_text='Referencia a la comisión original', on_delete=django.db.models.deletion.PROTECT, to='gestion_inmobiliaria.comisionventaasesor')),
            ],
            options={
                'verbose_name': 'Detalle de Comisión Cerrada',
                'verbose_name_plural': 'Detalles de Comisiones Cerradas',
                'ordering': ['asesor_nombre', 'fecha_venta'],
            },
        ),
        migrations.CreateModel(
            name='GestionCobranza',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('fecha_gestion', models.DateTimeField(auto_now_add=True)),
                ('tipo_contacto', models.CharField(choices=[('LLAMADA', 'Llamada Telefónica'), ('WHATSAPP', 'Mensaje de WhatsApp'), ('EMAIL', 'Correo Electrónico'), ('CARTA', 'Carta Notarial')], max_length=10)),
                ('resultado', models.TextField(help_text='Ej: Cliente confirma pago para el día de mañana.')),
                ('proximo_seguimiento', models.DateField(blank=True, null=True)),
                ('cuota', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='gestiones_cobranza', to='gestion_inmobiliaria.cuotaplanpago')),
                ('responsable', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, to=settings.AUTH_USER_MODEL)),
            ],
        ),
        migrations.AddField(
            model_name='cuotaplanpago',
            name='plan_pago_venta',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='cuotas', to='gestion_inmobiliaria.planpagoventa', verbose_name='Plan de Pago Asociado'),
        ),
        migrations.CreateModel(
            name='TablaComisionDirecta',
            fields=[
                ('id_tabla_comision', models.AutoField(primary_key=True, serialize=False)),
                ('rol', models.CharField(choices=[('captación', 'captación'), ('llamada', 'llamada'), ('liner', 'liner'), ('closer', 'closer')], max_length=20)),
                ('tipo_venta', models.CharField(choices=[('crédito', 'crédito'), ('contado', 'contado')], max_length=10)),
                ('porcentaje_comision', models.DecimalField(decimal_places=2, max_digits=5)),
            ],
            options={
                'verbose_name': 'Tabla de Comisión Directa',
                'verbose_name_plural': 'Tablas de Comisiones Directas',
                'ordering': ['rol', 'tipo_venta'],
                'unique_together': {('rol', 'tipo_venta')},
            },
        ),
        migrations.CreateModel(
            name='Venta',
            fields=[
                ('id_venta', models.CharField(editable=False, max_length=50, primary_key=True, serialize=False, unique=True, verbose_name='ID Venta')),
                ('fecha_venta', models.DateField(verbose_name='Fecha de Venta')),
                ('valor_lote_venta', models.DecimalField(decimal_places=2, max_digits=12, verbose_name='Valor de Venta Total (S/.)')),
                ('tipo_venta', models.CharField(choices=[('contado', 'Contado'), ('credito', 'Crédito')], default='contado', max_length=10, verbose_name='Tipo de Venta')),
                ('plazo_meses_credito', models.PositiveSmallIntegerField(choices=[(0, 'Contado / Sin Plan'), (12, 'Crédito 12 Meses'), (24, 'Crédito 24 Meses'), (36, 'Crédito 36 Meses')], default=0, help_text='0 para Contado. Seleccionar plazo si el tipo de venta es Crédito.', verbose_name='Plazo de Crédito (Meses)')),
                ('participacion_junior_venta', models.CharField(blank=True, choices=[('opc y call', 'OPC y Call'), ('opc, call y línea', 'OPC, Call y Línea'), ('opc, call, front', 'OPC, Call, Front'), ('N/A', 'No Aplica')], max_length=50, null=True, verbose_name='Participación Junior')),
                ('participacion_socio_venta', models.CharField(blank=True, choices=[('front', 'Front'), ('cierre', 'Cierre'), ('no participa', 'No Participa'), ('N/A', 'No Aplica')], max_length=20, null=True, verbose_name='Participación Socio')),
                ('modalidad_presentacion', models.CharField(blank=True, max_length=100, null=True, verbose_name='Modalidad Presentación')),
                ('status_venta', models.CharField(choices=[('separacion', 'Separación'), ('procesable', 'Procesable'), ('completada', 'Completada'), ('anulado', 'Anulado')], default='separacion', max_length=20, verbose_name='Status de la Venta')),
                ('monto_pagado_actual', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=12, verbose_name='Monto Pagado Actual (S/.)')),
                ('cuota_inicial_requerida', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=12, verbose_name='Cuota Inicial Requerida (S/.)')),
                ('cliente_firmo_contrato', models.BooleanField(default=False, verbose_name='¿Cliente Firmó Contrato?')),
                ('fecha_firma_contrato', models.DateField(blank=True, null=True, verbose_name='Fecha de Firma de Contrato')),
                ('notas', models.TextField(blank=True, null=True)),
                ('fecha_registro_venta', models.DateTimeField(default=django.utils.timezone.now, editable=False)),
                ('porcentaje_comision_vendedor_principal_personalizado', models.DecimalField(blank=True, decimal_places=2, help_text='Dejar en blanco para usar tabla de comisiones. Ingresar valor entre 0.00 y 100.00.', max_digits=5, null=True, validators=[django.core.validators.MinValueValidator(Decimal('0.00')), django.core.validators.MaxValueValidator(Decimal('100.00'))], verbose_name='Porcentaje Comisión Personalizada Vendedor Principal (%)')),
                ('porcentaje_comision_socio_personalizado', models.DecimalField(blank=True, decimal_places=2, help_text='Dejar en blanco para usar tabla de comisiones. Aplicable si hay socio participante. Ingresar valor entre 0.00 y 100.00.', max_digits=5, null=True, validators=[django.core.validators.MinValueValidator(Decimal('0.00')), django.core.validators.MaxValueValidator(Decimal('100.00'))], verbose_name='Porcentaje Comisión Personalizada Socio Participante (%)')),
                ('precio_dolares', models.DecimalField(blank=True, decimal_places=2, max_digits=12, null=True, verbose_name='Precio Venta ($)')),
                ('tipo_cambio', models.DecimalField(blank=True, decimal_places=3, max_digits=8, null=True, verbose_name='Tipo de Cambio (S/ por $)')),
                ('cliente', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='compras_cliente', to='gestion_inmobiliaria.cliente', verbose_name='Cliente')),
                ('id_socio_participante', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='participaciones_socio', to='gestion_inmobiliaria.asesor', verbose_name='ID Socio Participante')),
                ('lote', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='ventas_lote', to='gestion_inmobiliaria.lote', verbose_name='Lote Vendido')),
                ('vendedor_principal', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='ventas_realizadas', to='gestion_inmobiliaria.asesor', verbose_name='Vendedor Principal')),
            ],
            options={
                'verbose_name': 'Venta',
                'verbose_name_plural': 'Ventas',
                'ordering': ['-fecha_venta'],
            },
        ),
        migrations.CreateModel(
            name='RegistroPago',
            fields=[
                ('id_pago', models.CharField(editable=False, max_length=50, primary_key=True, serialize=False, unique=True, verbose_name='ID Pago')),
                ('fecha_pago', models.DateField(default=django.utils.timezone.now, verbose_name='Fecha del Pago')),
                ('monto_pago', models.DecimalField(blank=True, decimal_places=2, max_digits=12, null=True, verbose_name='Monto del Pago (S/.)')),
                ('monto_pago_dolares', models.DecimalField(blank=True, decimal_places=2, max_digits=12, null=True, verbose_name='Monto del Pago ($)')),
                ('tipo_cambio_pago', models.DecimalField(blank=True, decimal_places=3, max_digits=8, null=True, verbose_name='Tipo de Cambio del Pago (S/ por $)')),
                ('monto_pago_soles', models.DecimalField(blank=True, decimal_places=2, max_digits=12, null=True, verbose_name='Monto del Pago (S/.) calculado')),
                ('metodo_pago', models.CharField(blank=True, choices=[('efectivo', 'Efectivo'), ('transferencia', 'Transferencia Bancaria'), ('tarjeta_credito', 'Tarjeta de Crédito'), ('tarjeta_debito', 'Tarjeta de Débito'), ('yape_plin', 'Yape/Plin'), ('otro', 'Otro')], max_length=30, null=True, verbose_name='Método de Pago')),
                ('referencia_pago', models.CharField(blank=True, max_length=100, null=True, verbose_name='Referencia (N° Op, Código, etc.)')),
                ('notas_pago', models.TextField(blank=True, null=True, verbose_name='Notas Adicionales del Pago')),
                ('fecha_registro_pago', models.DateTimeField(default=django.utils.timezone.now, editable=False)),
                ('cuota_plan_pago_cubierta', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='pagos_que_la_cubren', to='gestion_inmobiliaria.cuotaplanpago', verbose_name='Cuota del Plan Cubierta (Opcional)')),
                ('venta', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='registros_pago', to='gestion_inmobiliaria.venta', verbose_name='Venta Asociada')),
            ],
            options={
                'verbose_name': 'Registro de Pago',
                'verbose_name_plural': 'Registros de Pagos',
                'ordering': ['-fecha_pago'],
            },
        ),
        migrations.CreateModel(
            name='Presencia',
            fields=[
                ('tipo_tour', models.CharField(choices=[('tour', 'Tour (Presencia Real)'), ('no_tour', 'No Tour (Cita Confirmada, No Presencia)')], default='tour', help_text='Indica si la cita fue un Tour (presencia real) o No Tour (no califica como presencia)', max_length=10, verbose_name='Tipo de Presencia (Tour/No Tour)')),
                ('id_presencia', models.CharField(editable=False, max_length=50, primary_key=True, serialize=False, unique=True, verbose_name='ID Presencia')),
                ('fecha_hora_presencia', models.DateTimeField(default=django.utils.timezone.now, verbose_name='Fecha y Hora de la Presencia/Cita')),
                ('proyecto_interes', models.CharField(max_length=255, verbose_name='Proyecto de Interés')),
                ('medio_captacion', models.CharField(choices=[('campo_opc', 'Campo OPC'), ('redes_facebook', 'Redes Facebook'), ('redes_instagram', 'Redes Instagram'), ('redes_tiktok', 'Redes TikTok'), ('referido', 'Referido'), ('web', 'Página Web'), ('otro', 'Otro')], max_length=50, verbose_name='Medio de Captación')),
                ('modalidad', models.CharField(choices=[('presencial', 'Presencial'), ('virtual', 'Virtual')], max_length=20, verbose_name='Modalidad de la Presencia')),
                ('status_presencia', models.CharField(choices=[('agendada', 'Agendada'), ('realizada', 'Realizada'), ('reprogramada', 'Reprogramada'), ('cancelada_cliente', 'Cancelada por Cliente'), ('no_asistio', 'No Asistió'), ('caida_proceso', 'Caída en Proceso')], default='agendada', max_length=30, verbose_name='Estado de la Presencia/Cita')),
                ('resultado_interaccion', models.CharField(blank=True, choices=[('interesado_seguimiento', 'Interesado - Programar Seguimiento'), ('interesado_separacion', 'Interesado - Realizó Separación'), ('interesado_venta_directa', 'Interesado - Venta Directa'), ('no_interesado_objecion', 'No Interesado - Objeción'), ('no_interesado_precio', 'No Interesado - Precio'), ('no_interesado_otro', 'No Interesado - Otro')], max_length=50, null=True, verbose_name='Resultado Específico de la Interacción')),
                ('observaciones', models.TextField(blank=True, null=True)),
                ('lugar_visita', models.CharField(blank=True, max_length=255, null=True, verbose_name='Lugar de Visita')),
                ('fecha_registro_sistema', models.DateTimeField(default=django.utils.timezone.now, editable=False)),
                ('ultima_modificacion', models.DateTimeField(auto_now=True)),
                ('asesor_call_agenda', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='presencias_agendadas_call', to='gestion_inmobiliaria.asesor', verbose_name='Asesor Call que Agendó')),
                ('asesor_captacion_opc', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='presencias_captadas_opc', to='gestion_inmobiliaria.asesor', verbose_name='Asesor Captación OPC/Redes')),
                ('asesor_closer', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='presencias_como_closer', to='gestion_inmobiliaria.asesor', verbose_name='Asesor Closer (Cierre)')),
                ('asesor_liner', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='presencias_como_liner', to='gestion_inmobiliaria.asesor', verbose_name='Asesor Liner (Presentación)')),
                ('cliente', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='presencias_cliente', to='gestion_inmobiliaria.cliente', verbose_name='Cliente')),
                ('lote_interes_inicial', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='presencias_interes_en_lote', to='gestion_inmobiliaria.lote', verbose_name='Lote de Interés Inicial')),
                ('venta_asociada', models.OneToOneField(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='presencia_que_origino', to='gestion_inmobiliaria.venta', verbose_name='Venta Asociada (si aplica)')),
            ],
            options={
                'verbose_name': 'Presencia de Cliente',
                'verbose_name_plural': 'Presencias de Clientes',
                'ordering': ['-fecha_hora_presencia'],
            },
        ),
        migrations.AddField(
            model_name='planpagoventa',
            name='venta',
            field=models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='plan_pago_venta', to='gestion_inmobiliaria.venta', verbose_name='Venta Asociada'),
        ),
        migrations.AddField(
            model_name='comisionventaasesor',
            name='venta',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='comisiones_asesores', to='gestion_inmobiliaria.venta', verbose_name='Venta Asociada'),
        ),
        migrations.AlterUniqueTogether(
            name='cuotaplanpago',
            unique_together={('plan_pago_venta', 'numero_cuota')},
        ),
        migrations.AlterUniqueTogether(
            name='comisionventaasesor',
            unique_together={('venta', 'asesor', 'rol')},
        ),
    ]
